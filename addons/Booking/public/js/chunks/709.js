"use strict";(self.webpackChunksubscription=self.webpackChunksubscription||[]).push([[709],{709:(t,e,o)=>{o.r(e),o.d(e,{default:()=>a,getEntry:()=>n});function n(t,e,o){axios.get("/api/collections/"+t+"/"+e).then((function(t){var e=t.data.data.matrix,n=t.data.data.entry,i={name:n.name,slug:n.slug,status:n.status,publish_at:n.publish_at,expire_at:n.expire_at};_.forEach(e.blueprint.sections,(function(t){_.forEach(t.fields,(function(t){i[t.handle]=n[t.handle]}))})),o(null,n,e,i)})).catch((function(t){o(new Error("The requested entry could not be found"))}))}const i={data:function(){return{collection:{},entry:{},booking:null,loadingBooking:!1}},methods:{loadBookingDetail:function(t){var e=this;this.loadingBooking=!0,this.booking=null,axios.get("/api/booking/"+t).then((function(t){e.loadingBooking=!1,e.booking=t.data.data})).catch((function(t){e.loadingBooking=!1,toast(t.response.data.message,"error")}))},destroy:function(t){axios.delete("/api/booking/"+t).then((function(t){toast("Booking successfully deleted.","success"),bus().$emit("refresh-datatable-bookings")}))}},computed:{endpoint:function(){return"/datatable/collection/"+this.$route.params.collection+"/"+this.$route.params.id+"/bookings"}},beforeRouteEnter:function(t,e,o){n(t.params.collection,t.params.id,(function(t,e,n,i){o(t?function(e){e.$router.push("/collection/"+e.$router.currentRoute.params.collection),toast(t.toString(),"danger")}:function(t){t.collection=n,t.entry=e,t.$emit("updateHead")})}))},beforeRouteUpdate:function(t,e,o){var i=this;n(t.params.collection,t.params.id,(function(t,e,o,n){t?(i.$router.push("/bookable-collection/"+i.$router.currentRoute.params.collection),toast(t.toString(),"danger")):(i.collection=o,i.entry=e,i.$emit("updateHead"))})),o()}};const a=(0,o(900).Z)(i,(function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",[o("portal",{attrs:{to:"title"}},[o("page-title",{attrs:{icon:t.collection.icon||"pencil-alt",subtitle:t.entry.name}},[t._v("Manage Bookings")])],1),t._v(" "),o("portal",{attrs:{to:"actions"}},[o("div",{staticClass:"buttons"},[t.collection.slug&&"sm"!=t.$mq?o("ui-button",{attrs:{to:{name:"bookable_collection.index",params:{collection:t.collection.slug}},variant:"secondary"}},[t._v("Go Back")]):t._e(),t._v(" "),t.collection.slug&&"sm"!=t.$mq?o("ui-button",{attrs:{to:{name:"bookable_collection.booking.create",params:{collection:t.collection.slug}},variant:"primary"}},[t._v("New Booking")]):t._e()],1)]),t._v(" "),o("ui-table",{key:"bookings_table",attrs:{id:"bookings",endpoint:t.endpoint,"sort-by":"created_at","sort-in":"desc"},scopedSlots:t._u([{key:"bookable_name",fn:function(e){return[t._v("\n            "+t._s(e.record.bookable.name)+"\n        ")]}},{key:"starts_at",fn:function(t){return[o("ui-datetime",{attrs:{timestamp:t.record.starts_at}})]}},{key:"ends_at",fn:function(t){return[o("ui-datetime",{attrs:{timestamp:t.record.ends_at}})]}},{key:"created_at",fn:function(t){return[o("ui-datetime",{attrs:{timestamp:t.record.created_at}})]}},{key:"actions",fn:function(e){return[o("ui-actions",{key:"entry_"+e.record.id+"_actions",attrs:{id:"entry_"+e.record.id+"_actions"}},[o("ui-dropdown-link",{directives:[{name:"modal",rawName:"v-modal:view-booking",value:e.record,expression:"table.record",arg:"view-booking"}],on:{click:function(o){return o.preventDefault(),t.loadBookingDetail(e.record.id)}}},[t._v("\n                    View Detail\n                ")]),t._v(" "),o("ui-dropdown-link",{attrs:{to:{name:"bookable_collection.booking.edit",params:{booking:e.record.id}}}},[t._v("Edit")]),t._v(" "),o("ui-dropdown-divider"),t._v(" "),o("ui-dropdown-link",{directives:[{name:"modal",rawName:"v-modal:delete-entry",value:e.record,expression:"table.record",arg:"delete-entry"}],staticClass:"danger",on:{click:function(t){t.preventDefault()}}},[t._v("\n                    Delete\n                ")])],1)]}}])}),t._v(" "),o("portal",{attrs:{to:"modals"}},[o("ui-modal",{key:"delete_entry",attrs:{name:"delete-entry",title:"Delete Entry"},scopedSlots:t._u([{key:"footer",fn:function(e){return[o("ui-button",{directives:[{name:"modal",rawName:"v-modal:delete-entry",arg:"delete-entry"}],staticClass:"ml-3",attrs:{variant:"danger"},on:{click:function(o){return t.destroy(e.data.id)}}},[t._v("Delete")]),t._v(" "),o("ui-button",{directives:[{name:"modal",rawName:"v-modal:delete-entry",arg:"delete-entry"}],attrs:{variant:"secondary"}},[t._v("Cancel")])]}}])},[o("p",[t._v("Are you sure you want to permenantly delete this booking?")])]),t._v(" "),o("ui-modal",{key:"view_booking",attrs:{name:"view-booking",title:"Booking Detail"},scopedSlots:t._u([{key:"default",fn:function(e){return[t.loadingBooking?o("div",[t._v("\n                    Loading...\n                ")]):t.booking&&t.booking.detail&&t.booking.detail.entry&&t.booking.detail.matrix?o("div",[o("div",[o("h3",[t._v(t._s(t.booking.bookable.name))])]),t._v(" "),o("div",{staticClass:"flex flex-wrap mb-3"},[o("div",{staticClass:"md:w-1/2 w-full"},[o("ui-label",[t._v("From")]),t._v(" "),o("ui-datetime",{attrs:{timestamp:t.booking.starts_at}})],1),t._v(" "),o("div",{staticClass:"md:w-1/2 w-full"},[o("ui-label",[t._v("To")]),t._v(" "),o("ui-datetime",{attrs:{timestamp:t.booking.ends_at}})],1)]),t._v(" "),t._l(t.booking.detail.matrix.blueprint.sections,(function(e){return o("div",{key:e.id},t._l(e.fields,(function(e){return o("div",{key:e.id},[o("ui-label",[t._v(t._s(e.name))]),t._v(" "),o("div",[t._v(t._s(t.booking.detail.entry[e.handle]))])],1)})),0)}))],2):t._e()]}},{key:"footer",fn:function(e){return[o("ui-button",{directives:[{name:"modal",rawName:"v-modal:view-booking",arg:"view-booking"}],attrs:{variant:"secondary"}},[t._v("Close")])]}}])})],1)],1)}),[],!1,null,null,null).exports},900:(t,e,o)=>{function n(t,e,o,n,i,a,r,s){var l,c="function"==typeof t?t.options:t;if(e&&(c.render=e,c.staticRenderFns=o,c._compiled=!0),n&&(c.functional=!0),a&&(c._scopeId="data-v-"+a),r?(l=function(t){(t=t||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext)||"undefined"==typeof __VUE_SSR_CONTEXT__||(t=__VUE_SSR_CONTEXT__),i&&i.call(this,t),t&&t._registeredComponents&&t._registeredComponents.add(r)},c._ssrRegister=l):i&&(l=s?function(){i.call(this,(c.functional?this.parent:this).$root.$options.shadowRoot)}:i),l)if(c.functional){c._injectStyles=l;var d=c.render;c.render=function(t,e){return l.call(e),d(t,e)}}else{var u=c.beforeCreate;c.beforeCreate=u?[].concat(u,l):[l]}return{exports:t,options:c}}o.d(e,{Z:()=>n})}}]);